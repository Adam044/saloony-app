<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>إدارة المستخدمين - Saloony</title>
  <link rel="icon" href="/Images/favicon.ico">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <script>
    // Simple auth guard for admin
    const adminToken = localStorage.getItem('adminToken');
    if (!adminToken) {
      window.location.replace('/auth.html');
    }
  </script>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji"; background: #f7fafc; color: #0f172a; margin: 0; }
    header { position: fixed; top: 0; left: 0; right: 0; background: #0f172a; color: #fff; padding: 12px 16px; display: flex; align-items: center; justify-content: space-between; box-shadow: 0 4px 12px rgba(0,0,0,0.1); z-index: 20; }
    main { padding: 90px 16px 24px; max-width: 1100px; margin: 0 auto; }
    .btn { display: inline-flex; align-items: center; gap: 8px; border-radius: 12px; padding: 10px 14px; font-weight: 600; cursor: pointer; border: none; }
    .btn-primary { background: #0f172a; color: #fff; }
    .btn-primary:hover { background: #0b1320; }
    .table-wrapper { background: #fff; border: 1px solid #e5e7eb; border-radius: 16px; box-shadow: 0 6px 18px rgba(0,0,0,0.06); overflow: hidden; }
    table { width: 100%; border-collapse: collapse; }
    thead th { background: #f9fafb; color: #6b7280; font-size: 12px; letter-spacing: .04em; text-transform: uppercase; text-align: right; padding: 12px 16px; }
    tbody td { padding: 14px 16px; font-size: 14px; border-top: 1px solid #f1f5f9; }
    tr:hover td { background: #f9fafb; }
    .badge { padding: 4px 8px; border-radius: 999px; font-size: 12px; font-weight: 700; }
    .badge-user { background: #DBEAFE; color: #1E40AF; }
    .badge-salon { background: #E5E7EB; color: #374151; }
    .badge-admin { background: #D1FAE5; color: #065F46; }
  </style>
</head>
<body>
  <header>
    <div style="display:flex; align-items:center; gap:8px">
      <i class="fas fa-users"></i>
      <strong>إدارة المستخدمين</strong>
    </div>
    <button class="btn btn-primary" onclick="window.location.href='/admin_dashboard.html'">
      <i class="fas fa-arrow-right"></i>
      عودة للوحة الإدارة
    </button>
  </header>
  <main>
    <div class="table-wrapper" id="users-container">
      <p style="text-align:center; color:#6b7280; padding: 24px;">جاري تحميل المستخدمين...</p>
    </div>
  </main>

  <script>
    const token = localStorage.getItem('adminToken');

    async function loadUsersStandalone() {
      const container = document.getElementById('users-container');
      container.innerHTML = '<p style="text-align:center; color:#6b7280; padding: 24px;">جاري تحميل المستخدمين...</p>';
      try {
        const res = await fetch('/api/admin/users', { headers: { 'Authorization': `Bearer ${token}` } });
        const users = await res.json();

        if (!Array.isArray(users) || users.length === 0) {
          container.innerHTML = '<p style="text-align:center; color:#6b7280; padding: 24px;">لا توجد سجلات مستخدمين حالياً.</p>';
          return;
        }

        container.innerHTML = `
          <table>
            <thead>
              <tr>
                <th>#</th>
                <th>الاسم</th>
                <th>البريد الإلكتروني</th>
                <th>الهاتف</th>
                <th>المدينة</th>
                <th>النوع</th>
              </tr>
            </thead>
            <tbody>
              ${users.map((u, i) => `
                <tr>
                  <td>${i + 1}</td>
                  <td style="font-weight:700; color:#0f172a">${u.name}</td>
                  <td>${u.email}</td>
                  <td>${u.phone || '---'}</td>
                  <td>${u.city || '---'}</td>
                  <td>
                    <span class="badge ${u.user_type === 'user' ? 'badge-user' : u.user_type === 'salon' ? 'badge-salon' : 'badge-admin'}">
                      ${u.user_type === 'user' ? 'مستخدم' : u.user_type === 'salon' ? 'صالون' : 'إدارة'}
                    </span>
                  </td>
                </tr>
              `).join('')}
            </tbody>
          </table>
        `;
      } catch (e) {
        console.error('Failed to load users:', e);
        container.innerHTML = '<p style="text-align:center; color:#EF4444; padding: 24px;">فشل تحميل بيانات المستخدمين.</p>';
      }
    }

    document.addEventListener('DOMContentLoaded', loadUsersStandalone);
  </script>
</body>
</html>